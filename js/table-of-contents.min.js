!function(){function a(a){var b,c,d=["h1","h2","h3","h4","h5","h6"],e=!1;for(c=0;c<d.length;c++)if(b=a.getElementsByTagName(d[c]),b.length>0){e=d[c];break}return e=e.toLowerCase().replace("h","")}function b(a,b,f,g,h,i){var j,k,l,m,n,m,o,p,q,r,s,t,u=[],v="tinymce-table-of-contents";for(l=0;l<b;l++)u.push("h"+(parseInt(h)+parseInt(l)));for(l=0;l<u.length;l++)for(j=a.getElementsByTagName(u[l]),m=0;m<j.length;m++)k=j[m],k.className+=" "+v;for(n=a.getElementsByClassName(v),t='<div class="tinymce-table-of-contents '+g+'">',l=0;l<n.length;l++)m=n[l].tagName.toLowerCase().replace("h",""),s=n[l].innerHTML.replace("<br>",""),o=c(h,m,f),i?(q=n[l].id,""===q?(p=d(h,m,l+1),e(p,"h"+m.toString(),s),p='<a href="'+p+'">'):p='<a href="'+q+'">',r=o+p+s+"</a><br>"):r=o+s+"<br>",t+=r;return t+="</div>"}function c(a,b,c){var d,e,f="";for(d=b-a,e=0;e<d*c;e++)f+="&nbsp;";return f='<span style="white-space: pre;">'+f+"</span>"}function d(a,b){var c,d,e,f;for(c=b-a,void 0===g[c]||null===g[c]?g[c]=1:g[c]++,d="#section_",f=0;f<=c;f++)d+=g[f]+"_";if(d=d.slice(0,-1),e=0===c)for(f=1;f<g.length;f++)g[f]=null;return d}function e(a,b,c){var d,e,f,g,h,i=tinyMCE.activeEditor.getBody();for(d=a.substring(1),e=i.getElementsByTagName(b),f=0;f<e.length;f++)if(g=e[f],h=g.innerHTML.replace("<br>",""),h===c&&""===g.id){g.id=d;break}}var f="",g=[];tinymce.PluginManager.add("table_of_contents",function(c,d){c.addButton("table_of_contents",{title:"Table of contents",cmd:"table_of_contents",image:d+"/../img/table-of-contents.png"}),c.addCommand("table_of_contents",function(){c.windowManager.open({title:"Table of contents",body:[{type:"textbox",name:"depth",label:"Table depth",value:"2"},{type:"textbox",name:"indentation",label:"Indentation ( in spaces )",value:"4"},{type:"textbox",name:"table_class",label:"Table class",value:"toc"},{type:"checkbox",name:"add_links",label:"Add links to sections",checked:!0}],onsubmit:function(d){var e,h,i,j=d.data.depth,k=d.data.indentation,l=d.data.table_class,m=d.data.add_links;e=document.createElement("html"),e.innerHTML=tinyMCE.activeEditor.getContent({format:"raw"}),h=a(e),i=b(e,j,k,l,h,m),c.insertContent(i),f="",g=[]}})})})}();